<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ƒê·∫•u Tr∆∞·ªùng H√¨nh H·ªçc - L·ªõp 7 (B·∫£n M·ªü R·ªông)</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    body { margin: 0; padding: 0; background-color: #0f172a; font-family: system-ui, -apple-system, sans-serif; }
    
    /* Animations */
    .bounce-in { animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards; }
    @keyframes bounceIn {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.05); opacity: 1; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .slide-up { animation: slideUp 0.4s ease-out forwards; }
    @keyframes slideUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
    @keyframes shake {
      10%, 90% { transform: translate3d(-1px, 0, 0); }
      20%, 80% { transform: translate3d(2px, 0, 0); }
      30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
      40%, 60% { transform: translate3d(4px, 0, 0); }
    }

    .option-card { transition: all 0.2s ease; cursor: pointer; }
    .option-card:hover:not(.disabled) { transform: translateY(-4px) scale(1.02); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2); }
    .option-card:active:not(.disabled) { transform: translateY(0) scale(0.98); }
    .option-card.disabled { cursor: not-allowed; opacity: 0.9; }
    
    .bg-pattern {
      background-image: radial-gradient(#334155 1px, transparent 1px);
      background-size: 20px 20px;
    }
    
    /* Hide scrollbar for nav */
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root" class="w-full min-h-screen flex flex-col"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // --- ICONS ---
    const Trophy = ({ size = 24, className = "" }) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path></svg>);
    const Swords = ({ size = 24, className = "" }) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"></polyline><line x1="13" x2="19" y1="19" y2="13"></line><line x1="16" x2="20" y1="16" y2="20"></line><line x1="19" x2="21" y1="21" y2="19"></line><polyline points="14.5 6.5 18 3 21 3 21 6 17.5 9.5"></polyline><line x1="5" x2="9" y1="14" y2="18"></line><line x1="7" x2="4" y1="17" y2="20"></line><line x1="3" x2="5" y1="19" y2="21"></line></svg>);
    const CheckCircle = ({ size = 24, className = "" }) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>);
    const XCircle = ({ size = 24, className = "" }) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"></circle><line x1="15" x2="9" y1="9" y2="15"></line><line x1="9" x2="15" y1="9" y2="15"></line></svg>);
    const Zap = ({ size = 24, className = "" }) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>);

    // --- B·ªò 15 C√ÇU H·ªéI ---
    const QUESTIONS = [
      {
        topic: "Kh·ªüi ƒë·ªông - T√™n g·ªçi",
        question: "Giao ƒëi·ªÉm c·ªßa 3 ƒë∆∞·ªùng TRUNG TUY·∫æN trong m·ªôt tam gi√°c c√≥ t√™n g·ªçi l√† g√¨?",
        options: ["Tr·ª±c t√¢m", "Tr·ªçng t√¢m", "T√¢m ƒë∆∞·ªùng tr√≤n n·ªôi ti·∫øp", "T√¢m ƒë∆∞·ªùng tr√≤n ngo·∫°i ti·∫øp"],
        correct: 1,
        explanation: "Ch√≠nh x√°c! Giao ƒëi·ªÉm 3 ƒë∆∞·ªùng trung tuy·∫øn g·ªçi l√† TR·ªåNG T√ÇM. N√≥ l√† ƒëi·ªÉm c√¢n b·∫±ng c·ªßa tam gi√°c."
      },
      {
        topic: "Kh·ªüi ƒë·ªông - T√™n g·ªçi",
        question: "TR·ª∞C T√ÇM c·ªßa tam gi√°c l√† giao ƒëi·ªÉm c·ªßa 3 ƒë∆∞·ªùng n√†o?",
        options: ["ƒê∆∞·ªùng cao", "ƒê∆∞·ªùng trung tuy·∫øn", "ƒê∆∞·ªùng trung tr·ª±c", "ƒê∆∞·ªùng ph√¢n gi√°c"],
        correct: 0,
        explanation: "ƒê√∫ng! TR·ª∞C T√ÇM l√† giao ƒëi·ªÉm c·ªßa 3 ƒê∆Ø·ªúNG CAO (k·∫ª vu√¥ng g√≥c t·ª´ ƒë·ªânh xu·ªëng c·∫°nh ƒë·ªëi di·ªán)."
      },
      {
        topic: "Ph√¢n gi√°c - Nh·∫≠n di·ªán",
        question: "Giao ƒëi·ªÉm c·ªßa 3 ƒë∆∞·ªùng PH√ÇN GI√ÅC trong tam gi√°c c√≥ t√≠nh ch·∫•t g√¨ ƒë·∫∑c bi·ªát?",
        options: ["C√°ch ƒë·ªÅu 3 ƒë·ªânh", "C√°ch ƒë·ªÅu 3 c·∫°nh", "N·∫±m tr√™n m·ªôt c·∫°nh", "Chia tam gi√°c th√†nh 3 ph·∫ßn b·∫±ng nhau"],
        correct: 1,
        explanation: "Tuy·ªát v·ªùi! Giao ƒëi·ªÉm 3 ƒë∆∞·ªùng ph√¢n gi√°c C√ÅCH ƒê·ªÄU 3 C·∫†NH. N√≥ ch√≠nh l√† t√¢m c·ªßa ƒë∆∞·ªùng tr√≤n n·∫±m l·ªçt th·ªèm b√™n trong tam gi√°c (ƒë∆∞·ªùng tr√≤n n·ªôi ti·∫øp)."
      },
      {
        topic: "Trung tr·ª±c - Nh·∫≠n di·ªán",
        question: "ƒêi·ªÉm C√ÅCH ƒê·ªÄU 3 ƒê·ªàNH c·ªßa m·ªôt tam gi√°c l√† giao ƒëi·ªÉm c·ªßa 3 ƒë∆∞·ªùng n√†o?",
        options: ["ƒê∆∞·ªùng cao", "ƒê∆∞·ªùng trung tuy·∫øn", "ƒê∆∞·ªùng trung tr·ª±c", "ƒê∆∞·ªùng ph√¢n gi√°c"],
        correct: 2,
        explanation: "R·∫•t t·ªët! V√¨ ƒëi·ªÉm ƒë√≥ c√°ch ƒë·ªÅu 3 ƒë·ªânh n√™n n√≥ l√† t√¢m ƒë∆∞·ªùng tr√≤n ƒëi qua 3 ƒë·ªânh (ngo·∫°i ti·∫øp). T√¢m n√†y l√† giao c·ªßa 3 ƒê∆Ø·ªúNG TRUNG TR·ª∞C."
      },
      {
        topic: "T√≠nh to√°n - G√≥c",
        question: "Cho tam gi√°c ABC, g√≥c A = 60¬∞. K·∫ª tia ph√¢n gi√°c AD (D thu·ªôc BC). S·ªë ƒëo g√≥c BAD l√† bao nhi√™u?",
        options: ["20¬∞", "30¬∞", "40¬∞", "60¬∞"],
        correct: 1,
        explanation: "ƒê√∫ng r·ªìi! Tia ph√¢n gi√°c chia ƒë√¥i g√≥c. N√™n g√≥c BAD = 60¬∞ : 2 = 30¬∞."
      },
      {
        topic: "T√≠nh to√°n - T√¨m x",
        question: "Cho tam gi√°c ABC c√≥ tr·ªçng t√¢m G. AM l√† ƒë∆∞·ªùng trung tuy·∫øn. Bi·∫øt ƒë·ªô d√†i ƒëo·∫°n AG = 4cm. T√≠nh ƒë·ªô d√†i ƒëo·∫°n th·∫≥ng AM?",
        options: ["6 cm", "8 cm", "2 cm", "12 cm"],
        correct: 0,
        explanation: "Xu·∫•t s·∫Øc! T√≠nh ch·∫•t tr·ªçng t√¢m: AG = 2/3 AM. T·ª´ ƒë√≥ suy ra AM = AG : (2/3) = 4 x 3/2 = 6cm."
      },
      {
        topic: "T√≠nh ch·∫•t - Ph√¢n gi√°c",
        question: "Cho ƒëi·ªÉm M n·∫±m tr√™n tia ph√¢n gi√°c c·ªßa g√≥c xOy. Kh·∫≥ng ƒë·ªãnh n√†o sau ƒë√¢y l√† ƒê√öNG?",
        options: [
          "ƒêi·ªÉm M c√°ch ƒë·ªÅu ƒëi·ªÉm O v√† tia Ox",
          "Kho·∫£ng c√°ch t·ª´ M ƒë·∫øn tia Ox l·ªõn h∆°n kho·∫£ng c√°ch t·ª´ M ƒë·∫øn tia Oy",
          "ƒêi·ªÉm M c√°ch ƒë·ªÅu hai tia Ox v√† Oy",
          "Tia MO vu√¥ng g√≥c v·ªõi tia Ox"
        ],
        correct: 2,
        explanation: "Ch√≠nh x√°c! T√≠nh ch·∫•t ƒë·∫∑c tr∆∞ng c·ªßa tia ph√¢n gi√°c: B·∫•t c·ª© ƒëi·ªÉm n√†o n·∫±m tr√™n tia ph√¢n gi√°c c≈©ng C√ÅCH ƒê·ªÄU hai c·∫°nh t·∫°o n√™n g√≥c ƒë√≥."
      },
      {
        topic: "T√≠nh to√°n N√¢ng cao",
        question: "Tam gi√°c ABC c√≥ g√≥c A = 80¬∞. Hai ƒë∆∞·ªùng ph√¢n gi√°c c·ªßa g√≥c B v√† g√≥c C c·∫Øt nhau t·∫°i I. T√≠nh s·ªë ƒëo g√≥c BIC?",
        options: ["100¬∞", "120¬∞", "130¬∞", "140¬∞"],
        correct: 2,
        explanation: "Gi·ªèi l·∫Øm! C√¥ng th·ª©c nhanh: G√≥c BIC = 90¬∞ + (G√≥c A)/2 = 90¬∞ + 40¬∞ = 130¬∞. Ho·∫∑c t√≠nh chi ti·∫øt: B+C = 180¬∞-80¬∞=100¬∞ => B/2 + C/2 = 50¬∞ => BIC = 180¬∞-50¬∞ = 130¬∞."
      },
      {
        topic: "Nh·∫≠n di·ªán H√¨nh",
        question: "Trong m·ªôt TAM GI√ÅC VU√îNG, Tr·ª±c t√¢m (giao 3 ƒë∆∞·ªùng cao) n·∫±m ·ªü v·ªã tr√≠ n√†o?",
        options: ["N·∫±m b√™n trong tam gi√°c", "N·∫±m tr√™n c·∫°nh huy·ªÅn", "N·∫±m ·ªü trung ƒëi·ªÉm c·∫°nh huy·ªÅn", "Tr√πng v·ªõi ƒë·ªânh g√≥c vu√¥ng"],
        correct: 3,
        explanation: "ƒê√∫ng! Trong tam gi√°c vu√¥ng, hai c·∫°nh g√≥c vu√¥ng ch√≠nh l√† hai ƒë∆∞·ªùng cao. Ch√∫ng c·∫Øt nhau ngay t·∫°i ƒë·ªânh g√≥c vu√¥ng, n√™n Tr·ª±c t√¢m tr√πng v·ªõi ƒë·ªânh g√≥c vu√¥ng."
      },
      {
        topic: "·ª®ng d·ª•ng Th·ª±c t·∫ø",
        question: "Ba gia ƒë√¨nh A, B, C s·ªëng ·ªü 3 v·ªã tr√≠ t·∫°o th√†nh m·ªôt tam gi√°c. H·ªç mu·ªën ƒë√†o chung m·ªôt c√°i gi·∫øng sao cho gi·∫øng C√ÅCH ƒê·ªÄU 3 NH√Ä. ƒêi·ªÉm ƒë√†o gi·∫øng l√† giao c·ªßa 3 ƒë∆∞·ªùng n√†o?",
        options: ["ƒê∆∞·ªùng cao", "ƒê∆∞·ªùng trung tuy·∫øn", "ƒê∆∞·ªùng trung tr·ª±c", "ƒê∆∞·ªùng ph√¢n gi√°c"],
        correct: 2,
        explanation: "Ch√≠nh x√°c! Gi·∫øng c√°ch ƒë·ªÅu 3 nh√† (3 ƒë·ªânh c·ªßa tam gi√°c). ƒêi·ªÉm c√°ch ƒë·ªÅu 3 ƒë·ªânh ch√≠nh l√† giao ƒëi·ªÉm c·ªßa 3 ƒë∆∞·ªùng TRUNG TR·ª∞C."
      },
      {
        topic: "·ª®ng d·ª•ng Th·ª±c t·∫ø",
        question: "M·ªôt c√¥ng vi√™n h√¨nh tam gi√°c ƒë∆∞·ª£c bao quanh b·ªüi 3 con ƒë∆∞·ªùng. C·∫ßn ƒë·∫∑t m·ªôt tr·∫°m ph√°t wifi sao cho tr·∫°m C√ÅCH ƒê·ªÄU 3 CON ƒê∆Ø·ªúNG. Tr·∫°m n√†y l√† giao c·ªßa 3 ƒë∆∞·ªùng n√†o?",
        options: ["ƒê∆∞·ªùng cao", "ƒê∆∞·ªùng trung tuy·∫øn", "ƒê∆∞·ªùng trung tr·ª±c", "ƒê∆∞·ªùng ph√¢n gi√°c"],
        correct: 3,
        explanation: "Qu√° chu·∫©n! Kho·∫£ng c√°ch t·ª´ tr·∫°m ƒë·∫øn 3 con ƒë∆∞·ªùng (3 c·∫°nh) b·∫±ng nhau. Giao ƒëi·ªÉm c√°ch ƒë·ªÅu 3 c·∫°nh l√† giao c·ªßa 3 ƒë∆∞·ªùng PH√ÇN GI√ÅC."
      },
      {
        topic: "B·∫´y - Tam gi√°c c√¢n",
        question: "Cho tam gi√°c ABC c√¢n t·∫°i A. G·ªçi AM l√† ƒë∆∞·ªùng ph√¢n gi√°c. Kh·∫≥ng ƒë·ªãnh n√†o sau ƒë√¢y l√† SAI?",
        options: [
          "AM ƒëi qua trung ƒëi·ªÉm c·ªßa ƒëo·∫°n th·∫≥ng BC",
          "AM vu√¥ng g√≥c v·ªõi ƒëo·∫°n th·∫≥ng BC",
          "ƒêi·ªÉm M c√°ch ƒë·ªÅu hai ƒë·ªânh B v√† C",
          "ƒê∆∞·ªùng ph√¢n gi√°c AM KH√îNG th·ªÉ l√† ƒë∆∞·ªùng cao"
        ],
        correct: 3,
        explanation: "B·∫°n ƒë√£ ph√°t hi·ªán ra l·ªói sai! Trong tam gi√°c c√¢n, ƒë∆∞·ªùng ph√¢n gi√°c xu·∫•t ph√°t t·ª´ ƒë·ªânh c√¢n ƒê·ªíNG TH·ªúI l√† ƒë∆∞·ªùng cao, ƒë∆∞·ªùng trung tuy·∫øn v√† ƒë∆∞·ªùng trung tr·ª±c."
      },
      {
        topic: "T√≠nh to√°n - Trung tr·ª±c",
        question: "ƒê∆∞·ªùng th·∫≥ng d l√† ƒë∆∞·ªùng trung tr·ª±c c·ªßa ƒëo·∫°n th·∫≥ng AB. ƒêi·ªÉm M n·∫±m tr√™n d. Bi·∫øt MA = 5cm, ƒë·ªô d√†i MB l√† bao nhi√™u?",
        options: ["2.5 cm", "5 cm", "10 cm", "Kh√¥ng th·ªÉ t√≠nh ƒë∆∞·ª£c"],
        correct: 1,
        explanation: "Ch√≠nh x√°c! ƒêi·ªÉm n·∫±m tr√™n ƒë∆∞·ªùng trung tr·ª±c c·ªßa m·ªôt ƒëo·∫°n th·∫≥ng th√¨ lu√¥n c√°ch ƒë·ªÅu hai m√∫t c·ªßa ƒëo·∫°n th·∫≥ng ƒë√≥. V·∫≠y MA = MB = 5cm."
      },
      {
        topic: "T·ªïng h·ª£p - Suy lu·∫≠n",
        question: "N·∫øu m·ªôt tam gi√°c c√≥ Tr·ªçng t√¢m TR√ôNG V·ªöI Tr·ª±c t√¢m th√¨ ƒë√≥ l√† lo·∫°i tam gi√°c g√¨?",
        options: ["Tam gi√°c vu√¥ng", "Tam gi√°c c√¢n", "Tam gi√°c ƒë·ªÅu", "Tam gi√°c t√π"],
        correct: 2,
        explanation: "Ho√†n h·∫£o! Khi trung tuy·∫øn tr√πng v·ªõi ƒë∆∞·ªùng cao ·ªü c·∫£ 3 ƒë·ªânh, ƒëi·ªÅu ƒë√≥ c√≥ nghƒ©a l√† c·∫£ 3 c·∫°nh c·ªßa tam gi√°c ƒë·ªÅu b·∫±ng nhau. ƒê√≥ l√† TAM GI√ÅC ƒê·ªÄU."
      },
      {
        topic: "Tr√πm cu·ªëi - B·∫´y Ph√¢n Gi√°c",
        question: "Hai ƒë∆∞·ªùng ph√¢n gi√°c xu·∫•t ph√°t t·ª´ ƒë·ªânh B v√† ƒë·ªânh C c·ªßa tam gi√°c ABC c·∫Øt nhau t·∫°i I. Kh·∫≥ng ƒë·ªãnh n√†o sau ƒë√¢y CH·∫ÆC CH·∫ÆN ƒê√öNG?",
        options: [
          "AI vu√¥ng g√≥c v·ªõi BC",
          "I l√† trung ƒëi·ªÉm c·ªßa BC",
          "AI l√† tia ph√¢n gi√°c c·ªßa g√≥c A",
          "AI ƒëi qua trung ƒëi·ªÉm c·ªßa BC"
        ],
        correct: 2,
        explanation: "Ch√∫c m·ª´ng em! Ba ƒë∆∞·ªùng ph√¢n gi√°c c·ªßa m·ªôt tam gi√°c c√πng ƒëi qua m·ªôt ƒëi·ªÉm. V√¨ I l√† giao c·ªßa 2 ph√¢n gi√°c B v√† C, n√™n ƒë∆∞·ªùng n·ªëi t·ª´ ƒë·ªânh c√≤n l·∫°i (A) ƒëi qua I CH·∫ÆC CH·∫ÆN l√† ƒë∆∞·ªùng ph√¢n gi√°c c·ªßa g√≥c A."
      }
    ];

    // --- MAIN GAME COMPONENT ---
    const GeometryGame = () => {
      const [currentQ, setCurrentQ] = useState(0);
      const [score, setScore] = useState(0);
      const [combo, setCombo] = useState(0);
      const [selectedAns, setSelectedAns] = useState(null);
      const [showResult, setShowResult] = useState(false);
      const [isFinished, setIsFinished] = useState(false);
      
      const q = QUESTIONS[currentQ];

      const handleSelect = (index) => {
        if (showResult) return; 
        setSelectedAns(index);
        setShowResult(true);

        if (index === q.correct) {
          setScore(s => s + 10 + (combo * 5)); // Base 10, bonus 5 per combo
          setCombo(c => c + 1);
        } else {
          setCombo(0); 
        }
      };

      const handleNext = () => {
        if (currentQ < QUESTIONS.length - 1) {
          setCurrentQ(currentQ + 1);
          setSelectedAns(null);
          setShowResult(false);
          // Scroll to top mobile smoothly
          window.scrollTo({ top: 0, behavior: 'smooth' });
        } else {
          setIsFinished(true);
        }
      };

      const restartGame = () => {
        setCurrentQ(0);
        setScore(0);
        setCombo(0);
        setSelectedAns(null);
        setShowResult(false);
        setIsFinished(false);
      };

      // --- M√ÄN H√åNH K·∫æT TH√öC ---
      if (isFinished) {
        const correctAnswers = score > 0 ? QUESTIONS.filter((_, i) => true).length /* T√≠nh logic ·ªü ƒë√¢y h∆°i ph·ª©c t·∫°p do combo, ta d√πng s·ªë c√¢u ƒë√∫ng ·∫©n */ : 0;
        // Logic t√≠nh l·∫°i s·ªë c√¢u ƒë√∫ng (V√¨ t√≠nh score theo combo h∆°i kh√≥ l√πi l·∫°i, ta gi·∫£ l·∫≠p s·ªë c√¢u ƒë√∫ng d·ª±a tr√™n s·ªë ƒëi·ªÉm)
        // C√°ch t·ªët nh·∫•t l√† th√™m 1 state rightCount, nh∆∞ng ƒë·ªÉ g·ªçn ta ƒë√°nh gi√° qua m·ª©c ƒëi·ªÉm.
        const maxScore = 15 * 10 + (14 * 15 / 2) * 5; // T·∫ßm 675 ƒëi·ªÉm
        
        let title = "B·∫¨C TH·∫¶Y H√åNH H·ªåC";
        let message = "Tuy·ªát v·ªùi! Em ƒë√£ n·∫Øm v·ªØng to√†n b·ªô ki·∫øn th·ª©c v·ªÅ 4 ƒë∆∞·ªùng trong tam gi√°c. K·ªπ nƒÉng t√≠nh to√°n v√† nh·∫≠n di·ªán r·∫•t xu·∫•t s·∫Øc!";
        let ringColor = "border-amber-400";
        let trophyBg = "bg-amber-400";
        let trophyGlow = "shadow-[0_0_50px_rgba(251,191,36,0.6)]";

        if (score < 200) {
          title = "CHI·∫æN BINH T·∫¨P S·ª∞";
          message = "Em ƒë√£ l√†m r·∫•t t·ªët, nh∆∞ng h√£y xem l·∫°i s·ªï tay c√¥ng th·ª©c m·ªôt ch√∫t ƒë·ªÉ kh√¥ng b·ªã s·∫≠p b·∫´y nh√©!";
          ringColor = "border-slate-400";
          trophyBg = "bg-slate-400";
          trophyGlow = "shadow-[0_0_50px_rgba(148,163,184,0.6)]";
        } else if (score < 400) {
          title = "CHUY√äN GIA GI·∫¢I TO√ÅN";
          message = "R·∫•t t·ªët! Em ƒë√£ hi·ªÉu r√µ c√°c t√≠nh ch·∫•t. Ch·ªâ c·∫ßn c·∫©n th·∫≠n h∆°n ·ªü nh·ªØng c√¢u t√≠nh to√°n ph·ª©c t·∫°p l√† ho√†n h·∫£o.";
          ringColor = "border-sky-400";
          trophyBg = "bg-sky-400";
          trophyGlow = "shadow-[0_0_50px_rgba(56,189,248,0.6)]";
        }

        return (
          <div className="flex-1 flex items-center justify-center p-4 bg-pattern relative overflow-hidden">
            <div className={`bg-slate-800 p-8 md:p-12 rounded-3xl shadow-2xl border-4 ${ringColor} max-w-2xl w-full text-center bounce-in z-10`}>
              <div className={`w-32 h-32 mx-auto ${trophyBg} rounded-full flex items-center justify-center mb-6 ${trophyGlow}`}>
                <Trophy size={64} className="text-white" />
              </div>
              <h2 className={`text-4xl font-black mb-2 ${score >= 400 ? 'text-amber-400' : 'text-white'}`}>{title}</h2>
              <p className="text-xl text-slate-300 mb-8">{message}</p>
              
              <div className="flex justify-center gap-6 mb-10">
                <div className="bg-slate-900/50 p-6 rounded-2xl w-40 border border-slate-700">
                  <p className="text-slate-400 font-bold mb-2">ƒêI·ªÇM S·ªê</p>
                  <p className="text-5xl font-black text-white">{score}</p>
                </div>
              </div>

              <button 
                onClick={restartGame}
                className="bg-indigo-600 hover:bg-indigo-500 text-white font-black text-xl px-10 py-4 rounded-full transition-transform hover:scale-105 active:scale-95 shadow-[0_0_20px_rgba(79,70,229,0.4)]"
              >
                CH∆†I L·∫†I T·ª™ ƒê·∫¶U
              </button>
            </div>
            
            {/* Background effects */}
            <div className="absolute top-0 left-0 w-64 h-64 bg-indigo-500/20 rounded-full blur-[100px]"></div>
            <div className="absolute bottom-0 right-0 w-64 h-64 bg-emerald-500/20 rounded-full blur-[100px]"></div>
          </div>
        );
      }

      // --- M√ÄN H√åNH CH∆†I ---
      const progressPercent = ((currentQ) / QUESTIONS.length) * 100;

      return (
        <div className="flex-1 flex flex-col items-center p-3 sm:p-6 bg-pattern pb-20">
          <div className="w-full max-w-4xl flex flex-col gap-5">
            
            {/* HEADER GAME: Stats & Progress */}
            <div className="bg-slate-800 rounded-2xl p-4 sm:p-5 flex flex-col gap-4 border border-slate-700 shadow-xl">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-3">
                  <div className="bg-indigo-600/20 p-2 sm:p-3 rounded-xl border border-indigo-500/30">
                    <Swords className="text-indigo-400" size={28} />
                  </div>
                  <div>
                    <div className="text-slate-400 font-bold text-xs sm:text-sm uppercase tracking-wider">C√¢u h·ªèi</div>
                    <div className="text-white font-black text-xl sm:text-2xl">{currentQ + 1} <span className="text-slate-500 text-lg">/ {QUESTIONS.length}</span></div>
                  </div>
                </div>

                <div className="flex items-center gap-4 text-right">
                  {combo >= 2 && (
                    <div className="hidden sm:flex text-amber-400 font-black animate-pulse items-center gap-1 bg-amber-400/10 px-3 py-1 rounded-full border border-amber-400/20">
                      <Zap size={16} /> L·ª≠a Combo x{combo}
                    </div>
                  )}
                  <div>
                    <div className="text-slate-400 font-bold text-xs sm:text-sm uppercase tracking-wider">ƒêi·ªÉm</div>
                    <div className="text-amber-400 font-black text-2xl sm:text-3xl font-mono">{score}</div>
                  </div>
                </div>
              </div>

              {/* Progress Bar M·ªõi - Li·ªÅn m·∫°ch thay v√¨ t·ª´ng ch·∫•m */}
              <div className="w-full bg-slate-900 rounded-full h-2.5 sm:h-3 overflow-hidden shadow-inner relative">
                <div 
                  className="h-full bg-gradient-to-r from-emerald-500 to-teal-400 transition-all duration-500 ease-out shadow-[0_0_10px_rgba(16,185,129,0.8)]"
                  style={{ width: `${progressPercent}%` }}
                ></div>
              </div>
            </div>

            {/* KHUNG C√ÇU H·ªéI */}
            <div className="bg-slate-800 rounded-3xl p-6 sm:p-10 border-t-4 border-indigo-500 shadow-2xl relative">
              <div className="absolute -top-3.5 left-6 sm:left-10 bg-indigo-500 text-white font-bold px-4 py-1.5 rounded-full text-xs sm:text-sm uppercase tracking-wider shadow-lg">
                {q.topic}
              </div>
              <h2 className="text-xl sm:text-2xl md:text-3xl font-bold text-white leading-snug mt-2 sm:mt-4 text-center sm:text-left">
                {q.question}
              </h2>
            </div>

            {/* C√ÅC L·ª∞A CH·ªåN */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 mt-1">
              {q.options.map((opt, idx) => {
                let cardClass = "bg-slate-800 border-slate-600 text-slate-200 hover:bg-slate-750 hover:border-indigo-400";
                let icon = null;
                
                if (showResult) {
                  cardClass = "bg-slate-800/80 border-slate-700 text-slate-500 disabled"; 
                  
                  if (idx === q.correct) {
                    cardClass = "bg-emerald-900/80 border-emerald-500 text-emerald-100 disabled shadow-[0_0_15px_rgba(16,185,129,0.2)]";
                    icon = <CheckCircle className="text-emerald-400" size={28} />;
                  } else if (idx === selectedAns) {
                    cardClass = "bg-red-900/80 border-red-500 text-red-100 shake disabled";
                    icon = <XCircle className="text-red-400" size={28} />;
                  }
                }

                const letter = String.fromCharCode(65 + idx); // A, B, C, D

                return (
                  <div 
                    key={idx}
                    onClick={() => handleSelect(idx)}
                    className={`option-card p-4 sm:p-5 rounded-2xl border-2 flex items-center gap-4 ${cardClass}`}
                  >
                    <div className={`w-10 h-10 sm:w-12 sm:h-12 rounded-xl flex items-center justify-center font-black text-lg sm:text-xl shrink-0 transition-colors
                      ${showResult && idx === q.correct ? 'bg-emerald-500 text-white' : 
                        showResult && idx === selectedAns ? 'bg-red-500 text-white' : 'bg-slate-700 text-slate-300'}`}>
                      {letter}
                    </div>
                    <span className="text-base sm:text-lg font-medium flex-1">{opt}</span>
                    {icon}
                  </div>
                );
              })}
            </div>

            {/* GI·∫¢I TH√çCH & NEXT BUTTON */}
            {showResult && (
              <div className="mt-2 slide-up w-full flex flex-col gap-4">
                <div className={`p-5 sm:p-6 rounded-2xl border-l-4 ${selectedAns === q.correct ? 'bg-emerald-900/30 border-emerald-500' : 'bg-red-900/30 border-red-500'}`}>
                  <h3 className={`font-black text-lg sm:text-xl mb-2 flex items-center gap-2 ${selectedAns === q.correct ? 'text-emerald-400' : 'text-red-400'}`}>
                    {selectedAns === q.correct ? 'üéâ CH√çNH X√ÅC!' : 'üí• √îI SAI R·ªíI!'}
                  </h3>
                  <p className="text-slate-300 text-base sm:text-lg leading-relaxed">{q.explanation}</p>
                </div>
                
                <button 
                  onClick={handleNext}
                  className="w-full bg-indigo-600 hover:bg-indigo-500 active:scale-[0.98] text-white font-black text-lg sm:text-xl py-4 sm:py-5 rounded-2xl transition-all shadow-[0_8px_20px_rgba(79,70,229,0.3)] flex justify-center items-center gap-2"
                >
                  {currentQ < QUESTIONS.length - 1 ? "C√ÇU TI·∫æP THEO" : "XEM B·∫¢NG ƒêI·ªÇM"} 
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg>
                </button>
              </div>
            )}

          </div>
        </div>
      );
    };

    // --- MAIN APP WRAPPER ---
    const App = () => {
      return (
        <div className="flex flex-col min-h-screen bg-slate-900">
          <header className="bg-slate-950 text-white px-4 sm:px-6 py-4 shadow-md z-20 shrink-0 border-b border-slate-800 flex justify-center sm:justify-start items-center">
            <h1 className="text-xl sm:text-2xl font-black uppercase tracking-tight flex items-center gap-2">
              <span className="text-amber-500">To√°n 7</span> <span className="text-slate-600 font-normal">|</span> ƒê·∫•u Tr∆∞·ªùng H√¨nh H·ªçc
            </h1>
          </header>
          
          <GeometryGame />
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
